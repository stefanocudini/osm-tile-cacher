<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>OSM Tile Cacher with Leaflet</title>
	<link rel="stylesheet" href="/js/leaflet/dist/leaflet.css" />
<style>
body {
	margin:0;
	background:#666;
	text-align:center
}
a {
	color: #ddd;
}
#map {
	position:absolute;
	top:18px;
	right:0;
	left:0;
	bottom:0;
	background:#fff;
}
#ctrls {
	padding:6px 0;
	width:150px;
	height:20px;
	margin:14px;
	background: #fff;
	box-shadow: 0 1px 7px rgba(0,0,0,0.4);
	border: 1px solid #888;
	color:#00e;
	opacity: .60;
	border-radius: 8px;		
}
</style>
</head>
<body>

<a href="https://github.com/stefanocudini/osm-tile-cacher">Osm Tile Cacher</a>

<div id="map"></div>

<a href="https://github.com/stefanocudini/osm-tile-cacher"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png" alt="Fork me on GitHub"></a>

<script src="/js/jquery-1.8.3.min.js"></script>
<script src="/js/leaflet/dist/leaflet.js"></script>
<script>
$(function() {

	var zoomStart = 9,
		centerStart = new L.LatLng(41.794008,12.583884),
		map = new L.Map('map',{center: centerStart}),
		grayLayer = new L.TileLayer('http://{s}.www.toolserver.org/tiles/bw-mapnik/{z}/{x}/{y}.png'),		
		osmLayer = new L.TileLayer('./tmsfake.php?{z}/{x}/{y}.png'),
		cacheLayer = new L.TileLayer('./cache-tiles/{z}/{x}/{y}.png');
	
	map.setView(centerStart, zoomStart);	
	map.addLayer(grayLayer);
	map.addLayer(osmLayer);
	
	map.addControl(L.Util.extend(new L.Control({position:'topleft'}),
				{onAdd: function(map) {
					return $('<div id="ctrls">'+
						'<label><input id="ckdown" type="checkbox" />Force Update Tiles</label>'+
						'<pre></pre></div>')[0];
				}
		}) );

	L.control.layers({"Caching Tiles": osmLayer, "Cached Tiles": cacheLayer}, {},{position:'bottomleft',collapsed:false}).addTo(map);

	$('#ckdown').on('change', function(e) {
		$('#ctrls pre').text('loading...').load('tmsfake.php',{ setopt: 1, ckdown: $(e.target).is(":checked") });
	});
});
</script>
<script type="text/javascript" src="/labs-common.js"></script>
</body>
</html>
