<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>OSM Tile Cacher with Leaflet</title>
	<link rel="stylesheet" href="/js/leaflet/dist/leaflet.css" />
<style>
body {
	margin:0;
	background:#666;
	text-align:center
}
a {
	color: #ddd;
}
#map {
	position:absolute;
	top:18px;
	right:0;
	left:0;
	bottom:0;
	background:#fff;
}
#ctrls {
	position:fixed;
	top:22px;
	right:50px;
	z-index:1000;
	padding:10px;
	width:160px;
	height:20px;
	border:1px solid #00e;
	background: #eee;
	color:#00e;
	opacity: .60;
	filter:Alpha(Opacity=60);	
	-moz-border-radius: .4em;
	-webkit-border-radius: .4em;
	border-radius: .4em;		
}
</style>
</head>
<body>

<a href="https://github.com/stefanocudini/osm-tile-cacher">Osm Tile Cacher</a>

<div id="map"></div>

<div id="ctrls">
	<label><input id="ckdown" name="ckdown" type="checkbox" />Force Update Tiles</label>
	<pre></pre>
</div>

<script src="/js/jquery-1.8.3.min.js"></script>
<script src="/js/leaflet/dist/leaflet.js"></script>
<script>
$(function() {

	var zoomStart = 9,
		centerStart = new L.LatLng(41.794008,12.583884),
		map = new L.Map('map',{center: centerStart}),
		grayLayer = new L.TileLayer('http://{s}.www.toolserver.org/tiles/bw-mapnik/{z}/{x}/{y}.png'),		
		osmLayer = new L.TileLayer('./tmsfake.php?{z}/{x}/{y}.png'),
		cacheLayer = new L.TileLayer('./cache-tiles/{z}/{x}/{y}.png');
	
	map.setView(centerStart, zoomStart);	
	map.addLayer(grayLayer);
	map.addLayer(osmLayer);

	L.control.layers({"Caching Tiles": osmLayer, "Cached Tiles": cacheLayer}, {},{position:'bottomleft',collapsed:false}).addTo(map);

	$('#ckdown').on('change', function(e) {
		$('#ctrls pre').text('loading...').load('tmsfake.php',{ setopt: 1, ckdown: $(e.target).is(":checked") });
	});
});
</script>
<script type="text/javascript" src="/labs-common.js"></script>
</body>
</html>
